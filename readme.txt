--Projeto desenvolvido com angular e grunt, para rodar executar "grunt" na pasta "projeto-web".
--com o browser-sync basta executar na pasta "projeto-web" o comando "browser-sync start --server"

drop database web;
create database web;

use web;

CREATE TABLE `PRODUTO` (
	`COD` INT NOT NULL AUTO_INCREMENT,
	`NOME` varchar(50) NOT NULL,
	`VALOR_AQUISICAO` double NOT NULL,
	`VALOR_VENDA` double NOT NULL,
	`FORNECEDOR` INT NOT NULL,
	PRIMARY KEY (`COD`)
);

CREATE TABLE ESTOQUE (
	COD INT NOT NULL AUTO_INCREMENT,
	COD_PRODUTO INT NOT NULL,
	QTD INT NOT NULL,
	ATUALIZACAO DATETIME,
	PRIMARY KEY (COD),
	FOREIGN KEY (COD_PRODUTO) REFERENCES PRODUTO(COD)
);

CREATE TABLE `FORNECEDOR` (
	`COD` INT NOT NULL AUTO_INCREMENT,
	`NOME` varchar(50) NOT NULL,
	`CPF` varchar(20) NOT NULL,
	`TELEFONE` varchar(15) NOT NULL,
	`ATIVO` boolean default true,
	PRIMARY KEY (`COD`)
);

CREATE TABLE `MOVIMENTO` (
	`COD` INT NOT NULL AUTO_INCREMENT,
	`DESCRICAO` varchar(100),
	`VALOR_TOTAL` double NOT NULL,
	`DATA` DATETIME NOT NULL,
	`TIPO` INT NOT NULL,
	PRIMARY KEY (`COD`)
);

CREATE TABLE `ITEM_MOVIMENTO` (
	`COD` INT NOT NULL AUTO_INCREMENT,
	`MOVIMENTO` INT NOT NULL,
	`VALOR` double NOT NULL,
	`PRODUTO` INT NOT NULL,
	`QTD` INT NOT NULL,
	PRIMARY KEY (`COD`)
);

CREATE TABLE `PAGAMENTO_FORNECEDOR` (
	`COD` INT NOT NULL AUTO_INCREMENT,
	`FORNECEDOR` INT NOT NULL,
	`MOVIMENTO` INT NOT NULL,
	PRIMARY KEY (`COD`)
);

CREATE TABLE `USUARIO` (
	`COD` INT NOT NULL AUTO_INCREMENT,
	`USUARIO` varchar(30) NOT NULL UNIQUE,
	`EMAIL` varchar(50) NOT NULL UNIQUE,
	`SENHA` varchar(30) NOT NULL,
	PRIMARY KEY (`COD`)
);

ALTER TABLE `PRODUTO` ADD CONSTRAINT `PRODUTO_fk0` FOREIGN KEY (`FORNECEDOR`) REFERENCES `FORNECEDOR`(`COD`);

ALTER TABLE `ITEM_MOVIMENTO` ADD CONSTRAINT `ITEM_MOVIMENTO_fk0` FOREIGN KEY (`MOVIMENTO`) REFERENCES `MOVIMENTO`(`COD`);

ALTER TABLE `ITEM_MOVIMENTO` ADD CONSTRAINT `ITEM_MOVIMENTO_fk1` FOREIGN KEY (`PRODUTO`) REFERENCES `PRODUTO`(`COD`);

ALTER TABLE `PAGAMENTO_FORNECEDOR` ADD CONSTRAINT `PAGAMENTO_FORNECEDOR_fk0` FOREIGN KEY (`FORNECEDOR`) REFERENCES `FORNECEDOR`(`COD`);

ALTER TABLE `PAGAMENTO_FORNECEDOR` ADD CONSTRAINT `PAGAMENTO_FORNECEDOR_fk1` FOREIGN KEY (`MOVIMENTO`) REFERENCES `MOVIMENTO`(`COD`);
